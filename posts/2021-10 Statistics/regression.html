<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Borja Requena">
<meta name="dcterms.date" content="2021-10-06">
<meta name="description" content="In a regression analysis, we look for a relationship between two variables. Here, we provide an introduction to linear regression from a statistics point of view with code examples.">

<title>Borja Requena - Statistics perspective on regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Borja Requena</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">Borja Requena</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/BorjaRequena"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/BorjaRequena"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Statistics perspective on regression</h1>
                  <div>
        <div class="description">
          In a regression analysis, we look for a relationship between two variables. Here, we provide an introduction to linear regression from a statistics point of view with code examples.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Statistics</div>
                <div class="quarto-category">Data Analysis</div>
                <div class="quarto-category">GLM</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Borja Requena </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">October 6, 2021</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression">Linear regression</a>
  <ul class="collapse">
  <li><a href="#finding-the-best-fit" id="toc-finding-the-best-fit" class="nav-link" data-scroll-target="#finding-the-best-fit">Finding the best fit</a></li>
  <li><a href="#regression-analysis" id="toc-regression-analysis" class="nav-link" data-scroll-target="#regression-analysis">Regression analysis</a></li>
  </ul></li>
  <li><a href="#example-weather-in-szeged" id="toc-example-weather-in-szeged" class="nav-link" data-scroll-target="#example-weather-in-szeged">Example: weather in Szeged</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>This post is part of a series in which we provide an introduction to statistics and data analysis introducing <a href="https://brequena.com/statistics/data%20analysis/anova/glms/2021/10/05/ANOVA.html">analysis of variance (ANOVA)</a> and regression. They contain most of the teaching material developed for the <a href="https://mmres.bist.eu/">Msc of Multidisciplinary Research in Experimental Sciences (BIST)</a>.</p>
<p>The main goal is to provide an intuition about the main ideas behind the different techniques together with simple code examples that implement them from scratch.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>We strongly recommend understanding the <a href="https://brequena.com/statistics/data%20analysis/anova/glms/2021/10/05/ANOVA.html">ANOVA</a> post before moving forward, as most concepts are the exact same. ANOVA and regression are forms of general linear models and, therefore, they are based on the same principles.</p>
</div>
</div>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>In a regression analysis we aim to find trends or relationships in our data. In the most basic scenario, we have an explanatory variable <span class="math inline">\(x\)</span> which we expect to have some influence over a response variable <span class="math inline">\(y\)</span> and the goal is to find the relationship between them. The explanatory variables can either be continuous or categorical, but the response variable is always continuous. Furthermore, the relationship between the two variables can be an arbitrarily complex function <span class="math inline">\(y(x)\)</span>, although in most applications it is a smooth function.</p>
<p>In this introductory post we will start by considering a single explanatory continuous variable and a linear relationship of the form <span class="math inline">\(y=\alpha+\beta x\)</span>, which is known as <strong>linear regression</strong>.</p>
</section>
<section id="linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="linear-regression">Linear regression</h2>
<p>As we have briefly introduced above, in a linear regression setting we only have a single explanatory variable <span class="math inline">\(x\)</span> that follows a linear relationship with the response variable <span class="math inline">\(y\)</span> of the form <span class="math inline">\(y=\alpha+\beta x\)</span>. A linear regression, while being the most simple form of regression, allows us to identify general trends in our data. Furthermore, any smooth function can be approximated by a straight line over a sufficiently short range. Therefore, in an extreme case, we can approximate any function by a series of linear regressions (not recommendable).</p>
<p>As in <a href="https://brequena.com/statistics/data%20analysis/anova/glms/2021/10/05/ANOVA.html">ANOVA</a>, the true values <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are inaccessible and the best we can do is to estimate them from our data, obtaining the coefficients <span class="math inline">\(a, b\)</span> such that <span class="math inline">\(y\approx a+bx\)</span>. Below, we show two examples of linear regression using synthetic data with <span class="math inline">\(\alpha=1, \beta=-1\)</span> and different degrees of noise. The black lines indicate the true relationship <span class="math inline">\(y=\alpha + \beta x\)</span> and the red lines show the best estimation <span class="math inline">\(y=a+bx\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> line(x, a, b):</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Evaluates `a + x*b`"</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a <span class="op">+</span> x<span class="op">*</span>b</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> synthetic_data(x, intercept, slope, std):</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Create a noisy synthetic dataset."</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> line(x, intercept, slope) <span class="op">+</span> std<span class="op">*</span>np.random.randn(<span class="bu">len</span>(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">7</span>) <span class="co"># Set random seed for reproducibility</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, n)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>a, b <span class="op">=</span> <span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>std_easy, std_hard <span class="op">=</span> <span class="fl">0.1</span>, <span class="fl">1.2</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>datasets <span class="op">=</span> synthetic_data(x, a, b, std_easy), synthetic_data(x, a, b, std_hard)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">4</span>))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>exact_relation <span class="op">=</span> line(x, a, b)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ax, ds <span class="kw">in</span> <span class="bu">zip</span>(axes, datasets):</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    ax.scatter(x, ds)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    ax.plot(x, exact_relation, color<span class="op">=</span><span class="st">'k'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    b_est, a_est <span class="op">=</span> np.polyfit(x, ds, <span class="dv">1</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    ax.plot(x, line(x, a_est, b_est), color<span class="op">=</span><span class="st">'r'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    ax.grid()</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    ax.tick_params(labelsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim(<span class="op">-</span><span class="fl">2.5</span>, <span class="fl">3.5</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    ax.text(<span class="op">-</span><span class="fl">0.49</span>, <span class="fl">2.6</span>, <span class="ss">f"a=</span><span class="sc">{</span>a_est<span class="sc">:.3f}</span><span class="ss">, b=</span><span class="sc">{</span>b_est<span class="sc">:.3f}</span><span class="ss">"</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">"y"</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">"x"</span>, fontsize<span class="op">=</span><span class="dv">20</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="regression_files/figure-html/cell-5-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>In the left plot, we see that the estimates <span class="math inline">\(a,b\)</span> are pretty accurate, given that the data follows a nearly perfect linear relationship. However, in the right plot the linear relationship is not so clear and we only find a generic trend on the data. Consequently, in this last case, the relative errors in the estimation of the coefficients is an order of magnitude larger than in the previous case.</p>
<section id="finding-the-best-fit" class="level3">
<h3 class="anchored" data-anchor-id="finding-the-best-fit">Finding the best fit</h3>
<p>Now that we have built some intuition about he problem, let us dive into the details of how we find the previous red lines. The best fit is the line that minimizes the sum of all errors to our data points. However, the deviations from the line <span class="math inline">\(y_i-y(x_i)\)</span> can take positive and negative values, as in the calculation of the variance in <a href="https://brequena.com/statistics/data%20analysis/anova/glms/2021/10/05/ANOVA.html">ANOVA</a>. Hence, we quantify the error by the sum of squares (SS) of the deviations <span class="math display">\[SS = \sum_{i=1}^n (y_i-y(x_i))^2,\]</span> where <span class="math inline">\(y(x_i)\)</span> indicates the prediction of the fit line at the point <span class="math inline">\(x_i\)</span>. The minimization of the SS gives the name to the algorithm: <strong>least squares</strong>.</p>
<p>In practice, this optimization is usually performed by derivating <span class="math inline">\(SS\)</span> with respect to the function parameters and setting the equations to zero, as in <a href="https://en.wikipedia.org/wiki/Linear_least_squares#Example">this example</a>. In this case, we would solve the system of equations <span class="math display">\[
\begin{align}
\frac{\partial SS}{\partial a} &amp;= 2\left(na - \sum_{i=1}^n y_i - bx_i\night) = 0 \\
\frac{\partial SS}{\partial b} &amp;= -2\sum_{i=1}^n x_i(y_i-a-bx_i) = 0
\end{align}
\]</span> considering that every term in the <span class="math inline">\(SS\)</span> can be expressed as <span class="math inline">\((y_i-a-bx_i)^2\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, n)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>std <span class="op">=</span> <span class="fl">0.2</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> synthetic_data(x, a, b, std)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>b_est, a_est <span class="op">=</span> np.polyfit(x, y, <span class="dv">1</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>fit <span class="op">=</span> line(x, a_est, b_est)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">7</span>, <span class="dv">4</span>))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>plt.scatter(x, y)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>plt.plot(x, fit, color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="fl">0.05</span>, <span class="fl">1.65</span>, <span class="ss">f"a=</span><span class="sc">{</span>a_est<span class="sc">:.4f}</span><span class="ss">, b=</span><span class="sc">{</span>b_est<span class="sc">:.4f}</span><span class="ss">"</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>plt.tick_params(labelsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"y"</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"x"</span>, fontsize<span class="op">=</span><span class="dv">20</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="regression_files/figure-html/cell-7-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="regression-analysis" class="level3">
<h3 class="anchored" data-anchor-id="regression-analysis">Regression analysis</h3>
<section id="anova" class="level4">
<h4 class="anchored" data-anchor-id="anova">ANOVA</h4>
<p>In order to perform the analysis, we can understand the optimization process in a different way:</p>
<p>As in ANOVA, we start by fitting the grand mean of the data <span class="math inline">\(\bar{y}\)</span>. This results into a flat line of the form <span class="math inline">\(y=\bar{y}\)</span> from which the deviations of all points add up to zero. We quantify the error arround the mean with the previously introduced <span class="math inline">\(SS_{total}\)</span> from ANOVA, which we denote as <strong><span class="math inline">\(SSY\)</span></strong> as we shift towards a more general notation.</p>
<p>Then, we rotate the line around the mean coordinate <span class="math inline">\((\bar{x}, \bar{y})\)</span> until we find the one that minimizes the error. Rotating the line, we bring it closer to the data points reducing the overall deviations. Nevertheless, there will still be some variability left to be explained, unless the data follows a perfect line, which we refer to as the error SS denoted <strong><span class="math inline">\(SSE\)</span></strong>. This is the equivalent quantity to the <span class="math inline">\(SS_{within}\)</span> introduced in ANOVA, which quantifies the error between our fit and the datapoints.</p>
<p>The difference between <span class="math inline">\(SSY\)</span> and <span class="math inline">\(SSE\)</span> is the variability captured by the regression, denoted <strong><span class="math inline">\(SSR\)</span></strong> (analogous to <span class="math inline">\(SS_{between}\)</span>) which quantifies the distance between the grand mean and the fit. Hence, these quantities follow the relationship <span class="math display">\[SSY = SSR + SSE\]</span></p>
<p>In the plots below we illustrate the distances quantified by each of the terms in a new synthetic dataset.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">4</span>))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Total SS</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>grand_mean <span class="op">=</span> y.mean()</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].scatter(x, y)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].hlines(grand_mean, x[<span class="dv">0</span>], x[<span class="op">-</span><span class="dv">1</span>], alpha<span class="op">=</span><span class="fl">0.9</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].scatter(x, y)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].plot(x, fit, color<span class="op">=</span><span class="st">'r'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].plot(x, fit, color<span class="op">=</span><span class="st">'r'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].hlines(grand_mean, x[<span class="dv">0</span>], x[<span class="op">-</span><span class="dv">1</span>], alpha<span class="op">=</span><span class="fl">0.9</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> xi, yi, fi <span class="kw">in</span> <span class="bu">zip</span>(x, y, fit):</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">0</span>].vlines(xi, yi, grand_mean, linestyles<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">1</span>].vlines(xi, yi, fi, linestyles<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    axes[<span class="dv">2</span>].vlines(xi, fi, grand_mean, linestyles<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="vs">r"$SSY$"</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="vs">r"$SSE$"</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_title(<span class="vs">r"$SSR$"</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ax <span class="kw">in</span> axes:</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim(<span class="op">-</span><span class="fl">0.22</span>, <span class="fl">2.4</span>)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    ax.tick_params(labelsize<span class="op">=</span><span class="dv">13</span>)</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">"y"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">"x"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>    ax.grid(alpha<span class="op">=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="regression_files/figure-html/cell-8-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>In order to perform the proper statistical analysis, we have to take into account the partition of the degrees of freedom (DF). For a dataset with <span class="math inline">\(n\)</span> points, we have <span class="math inline">\((n-1)\)</span> DF for <span class="math inline">\(SSY\)</span> as we know that the deviations are subject to the constraint of adding up to zero. This way, if we know the value of <span class="math inline">\((n-1)\)</span> deviations, we can infer the value of the last one.</p>
<p>For <span class="math inline">\(SSR\)</span> we have two DF <span class="math inline">\(a, b\)</span>. However, since we have the constraint that the line must go through the mean point <span class="math inline">\((\bar{x}, \bar{y})\)</span>, finding one parameter immediately sets the other and, therefore, we only have one DF. Hence, there are <span class="math inline">\(n-2\)</span> remaining DF for <span class="math inline">\(SSE\)</span> corresponding to the original <span class="math inline">\(n-1\)</span> DF minus a regression coefficient. This last one can also be understood as that we lose two degrees of freedom estimating <span class="math inline">\(a, b\)</span> from the <span class="math inline">\(n\)</span> data points.</p>
<p>With these quantities, we can perform the ANOVA of our regression.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>grand_mean <span class="op">=</span> y.mean()</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>sse <span class="op">=</span> np.<span class="bu">sum</span>((y <span class="op">-</span> fit)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>ssr <span class="op">=</span> np.<span class="bu">sum</span>((fit <span class="op">-</span> grand_mean)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>dfe, dfr <span class="op">=</span> n<span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>mse, msr <span class="op">=</span> sse<span class="op">/</span>dfe, ssr<span class="op">/</span>dfr</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>f_ratio <span class="op">=</span> msr<span class="op">/</span>mse</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"F-ratio of </span><span class="sc">{</span>f_ratio<span class="sc">:.4f}</span><span class="ss">."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>F-ratio of 151.2594.</code></pre>
</div>
</div>
<p>Promising F-ratio! Seems like a good fit, we just need to check a couple more things :)</p>
</section>
<section id="r-squared" class="level4">
<h4 class="anchored" data-anchor-id="r-squared">R-squared</h4>
<p>With the same quantities used for the ANOVA, we can compute the <strong><span class="math inline">\(R^2\)</span></strong> metric. The <span class="math inline">\(R^2\)</span> quantifies the fraction of variability explained by the resulting fit <span class="math display">\[R^2 = \frac{SSY-SSE}{SSY} = \frac{SSR}{SSY}.\]</span> In the case of a perfect fit, <span class="math inline">\(SSE=1\)</span> and <span class="math inline">\(R^2=1\)</span>. Hence, values of <span class="math inline">\(R^2\)</span> close to one are indicative of a good fit, while small values may suggest that there are other important variables besides <span class="math inline">\(x\)</span> influencing <span class="math inline">\(y\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>ssy <span class="op">=</span> np.<span class="bu">sum</span>((y <span class="op">-</span> grand_mean)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>r_sq <span class="op">=</span> ssr<span class="op">/</span>ssy</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"R^2=</span><span class="sc">{</span>r_sq<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R^2=0.8937</code></pre>
</div>
</div>
<p>Quite high <span class="math inline">\(R^2\)</span> means that most of the variance in the data is captured by our regression. Very good fit!</p>
</section>
<section id="significant-relationships" class="level4">
<h4 class="anchored" data-anchor-id="significant-relationships">Significant relationships</h4>
<p>Once we estimate our coefficients <span class="math inline">\(a,b\)</span> we have to address the question of whether the relationship that we have found is statistically relevant. The strength of the relationship is determined by the resulting slope and so we want to know what are the odds that the obtained slope could have simply happened by chance alone.</p>
<p>This way, we formulate our null hypothesis of no relationship <span class="math inline">\(\beta=0\)</span>, as it is quite natural to assume that there is no relationship until the evidence shows otherwise. Then, we compute the standard error of our slope estimation <span class="math inline">\(\varepsilon_b\)</span>, with which we can check how many standard deviations lie between our estimation from the null hypothesis <span class="math inline">\(t=b/\varepsilon_b\)</span>. Finally, we can perform a t-test and accept or reject the null hypothesis accordingly.</p>
<p>The standard error of the slope is obtained as <span class="math inline">\(\varepsilon_b=\sqrt{\frac{MSE}{SSX}}\)</span>, where <span class="math inline">\(MSE=SSE/DFE\)</span> and <span class="math inline">\(SSX=\sum_{i=1}^n (x_i - \bar{x})^2\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>ssx <span class="op">=</span> np.<span class="bu">sum</span>((x <span class="op">-</span> x.mean())<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>eb <span class="op">=</span> np.sqrt(mse<span class="op">/</span>ssx)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>t_val <span class="op">=</span> b_est<span class="op">/</span>eb</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>t_ratio <span class="op">=</span> t.pdf(t_val, df<span class="op">=</span>dfe)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"t-ratio </span><span class="sc">{</span>t_ratio<span class="sc">:.2e}</span><span class="ss"> for </span><span class="sc">{</span>t_val<span class="sc">:.2f}</span><span class="ss"> standard deviations away from null hypothesis"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>t-ratio 2.23e-10 for -12.30 standard deviations away from null hypothesis</code></pre>
</div>
</div>
</section>
<section id="confidence-intervals" class="level4">
<h4 class="anchored" data-anchor-id="confidence-intervals">Confidence intervals</h4>
<p>Our fitting is subject to statistical fluctuations, which means that it is subject to the amount of data that we have access to. Since we can only work with a limited amount of data points, if we were to repeat the whole process given a different sample from the exact same phenomenon our estimation of the regression coefficients <span class="math inline">\(a,b\)</span> would vary. The more data points we have, the smaller these variations would be and, therefore, the more confident we can be about our results.</p>
<p>Therefore, it is of extreme importance to not only provide our results, but also a measure of the confidence of our estimation. A common practice is to provide intervals in which we are <span class="math inline">\(95\%\)</span> sure that our estimaties lie within. In regression we can provide confidence intervals for both the coefficients and the predictions.</p>
<ul>
<li><strong>Coefficient interval</strong></li>
</ul>
<p>We have computed the standard error of the slope to assess whether the relationship that we have found is statistically significant. These errors allow us to compute confidence intervals for our regression coefficients in a very simple way following the relationship <span class="math display">\[CI = \text{coeff}\pm t_{\text{crit}}\varepsilon_{\text{coeff}}.\]</span> For instance, in the case of the slope we would report <span class="math display">\[CI_b = \text{b}\pm t_{\text{crit}}\varepsilon_b,\]</span> where <span class="math inline">\(t_{\text{crit}}\)</span> is the <a href="https://en.wikipedia.org/wiki/Student%27s_t-distribution#Table_of_selected_values">value of the <span class="math inline">\(t\)</span>-distribution</a> corresponding to the desired confidence, according to the DF. The DF for these estimates are always the DFE.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>t_crit <span class="op">=</span> <span class="fl">2.101</span> <span class="co"># two-sided 95% for 18 df</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>conf <span class="op">=</span> t_crit<span class="op">*</span>eb</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The vlaue of the slope is </span><span class="sc">{</span>b_est<span class="sc">:.4f}</span><span class="ss">+-</span><span class="sc">{</span>conf<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The true value lies in (</span><span class="sc">{</span>b_est<span class="op">-</span>conf<span class="sc">:.4f}</span><span class="ss">, </span><span class="sc">{</span>b_est<span class="op">+</span>conf<span class="sc">:.4f}</span><span class="ss">) with 95% confidence."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The vlaue of the slope is -0.9723+-0.1661
The true value lies in (-1.1384, -0.8062) with 95% confidence.</code></pre>
</div>
</div>
<ul>
<li><strong>Prediction interval</strong></li>
</ul>
<p>The same way we have errors and build coefficient interavls in the regression coefficients, we can also provide a measure of confidence for our predictions. In this case, we have to account for two factors influencing the error.</p>
<p>On the one hand, even if we assume that our fit <span class="math inline">\(y=a+bx\)</span> matches the true line <span class="math inline">\(y=\alpha+\beta x\)</span>, there will still be some uncertainty due to scattering around the true line. We can provide a confidence interval just as before <span class="math display">\[CI = y\pm t_{\text{crit}}s,\]</span> where <span class="math inline">\(s\)</span> is the standard deviation of the error <span class="math inline">\(s=\sqrt{MSE}\)</span>.</p>
<p>On the other hand, we also have to account for the fact that our fit does not match the exact true line. The prediction error will be heavily affected by the accuracy with which the slope and the intercept have been estimated. The more samples we have, the better estimates of the coefficients and, the closer to the mean point <span class="math inline">\((\bar{x},\bar{y})\)</span>, the smaller the influence of the slope errors.</p>
<p>Taking all these aspects into account, we can assign a prediction uncertainty <span class="math inline">\(PI\)</span> to every point <span class="math inline">\(x\)</span> of the form <span class="math display">\[PI(x)=y(x)\pm t_{\text{crit}}s\sqrt{\frac{1}{m}+\frac{1}{n}+\frac{x-\bar{x}}{SSX}},\]</span> where every source of uncertainty adds an additional term: <span class="math inline">\(\frac{1}{m}\)</span> quantifies the scattering around the true line, with <span class="math inline">\(m\)</span> being the number of <span class="math inline">\(y\)</span> values at <span class="math inline">\(x\)</span> (<span class="math inline">\(m=1\)</span> in our case); <span class="math inline">\(\frac{1}{n}\)</span> quantifies the uncertainty in the intercept estimation <span class="math inline">\(a\)</span>, the more datapoints, the lower the error; <span class="math inline">\(\frac{x-\bar{x}}{SSX}\)</span> accounts for the uncertainty in the slope, the errors grow as we get further from the mean point.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> np.sqrt(mse)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>xx <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">100</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> line(xx, a_est, b_est)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>interval <span class="op">=</span> t_crit<span class="op">*</span>s<span class="op">*</span>np.sqrt(<span class="dv">1</span><span class="op">/</span>m <span class="op">+</span> <span class="dv">1</span><span class="op">/</span>n <span class="op">+</span> (xx <span class="op">-</span> x.mean())<span class="op">/</span>ssx)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>plt.scatter(x, y)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>plt.plot(xx, pred, color<span class="op">=</span><span class="st">'r'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>plt.fill_between(xx, pred <span class="op">+</span> interval, pred <span class="op">-</span> interval, alpha<span class="op">=</span><span class="fl">0.15</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>plt.tick_params(labelsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"x"</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"y"</span>, fontsize<span class="op">=</span><span class="dv">20</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="regression_files/figure-html/cell-15-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="influential-points-and-outliers" class="level4">
<h4 class="anchored" data-anchor-id="influential-points-and-outliers">Influential points and outliers</h4>
<p>The main goal in regression is to minimize the SS from our fit line to the datapoints. As we have seen, all the fit lines go through the mean point <span class="math inline">\((\bar{x}, \bar{y})\)</span> and pivot around it. Hence, the error around this piont is rather small and barely influenced by the regression coeffcients.</p>
<p>On the contrary, the predictions on the points far from the center are largely influenced by the estimation of the slope and, therefore, they are subject to larger errors. Hence, these points dominate the SS, becoming the most important ones in the minimization. We call these points <strong>influential points</strong> as they can significantly affect our estimates <span class="math inline">\(a, b\)</span>.</p>
<p>Additionally, we have to account for <strong>outliers</strong>, which are points that do not follow the distribution of our data. We can identify these points by standardizing the residuals diving by their standard deviation. This way, we should find <span class="math inline">\(95\%\)</span> of our samples within 2 standard deviations from the line. The outliers are the remaining <span class="math inline">\(5\%\)</span> of our data (1 every 20 samples) and, by definition, lie far from the line yielding large errors.</p>
<p>Outliers can be extremely harmful for our estimation if they are found in an influential position. In some cases, the data is curated by removing the outliers in order to prevent such situations. However, that is not the best practice and, whenever it is performed, there should be reported results before and after the outlier removal.</p>
<p>Below we show three cases in which we can see the effect of influential points.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>x_out <span class="op">=</span> [<span class="fl">1.5</span>, <span class="fl">1.5</span>, <span class="fl">0.1</span>]</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>y_out <span class="op">=</span> a <span class="op">+</span> b<span class="op">*</span>x_out[<span class="dv">0</span>], <span class="fl">0.6</span>, <span class="dv">0</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">4</span>))</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ax, x_o, y_o <span class="kw">in</span> <span class="bu">zip</span>(axes, x_out, y_out):</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    x_ext, y_ext <span class="op">=</span> np.concatenate((x, [x_o])), np.concatenate((y, [y_o]))</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    exact_relation <span class="op">=</span> line(x_ext, a, b)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    ax.scatter(x, y)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    ax.scatter(x_o, y_o, color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    ax.plot(x_ext, exact_relation, color<span class="op">=</span><span class="st">'k'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    b_est, a_est <span class="op">=</span> np.polyfit(x_ext, y_ext, <span class="dv">1</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    ax.plot(x_ext, line(x_ext, a_est, b_est), color<span class="op">=</span><span class="st">'r'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    ax.grid()</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    ax.tick_params(labelsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim(<span class="op">-</span><span class="fl">2.5</span>, <span class="fl">3.5</span>)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    ax.text(<span class="op">-</span><span class="fl">0.49</span>, <span class="fl">2.6</span>, <span class="ss">f"a=</span><span class="sc">{</span>a_est<span class="sc">:.3f}</span><span class="ss">, b=</span><span class="sc">{</span>b_est<span class="sc">:.3f}</span><span class="ss">"</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">"y"</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">"x"</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">"Beneficial"</span>,fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">"Harmful outlier"</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">2</span>].set_title(<span class="st">"Harmless outlier"</span>, fontsize<span class="op">=</span><span class="dv">20</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="regression_files/figure-html/cell-16-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>On the left, we see an influential point that is over the exact distributiond. Then, in the middle, we see an influential point that is an outlier, significantly harming the resulting fit. Finally, on the right, we see an outlier that is found in a position with little influence, barely affecting our fit.</p>
</section>
</section>
</section>
<section id="example-weather-in-szeged" class="level2">
<h2 class="anchored" data-anchor-id="example-weather-in-szeged">Example: weather in Szeged</h2>
<p>Let’s now perform a regression analysis on a real example. We’ve taken the <a href="https://www.kaggle.com/budincsevity/szeged-weather">weather in Szeged 2006-2016 dataset</a> from <a href="https://www.kaggle.com/">Kaggle</a>. We will see whether there is any clear relationship between the apparent temperature and the humidity.</p>
<p>In order to make things easy, we’ve taken a small sample of the whole dataset with 50 points.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>humidity <span class="op">=</span> np.array([<span class="fl">0.98</span>, <span class="fl">0.85</span>, <span class="fl">0.82</span>, <span class="fl">0.75</span>, <span class="fl">0.85</span>, <span class="fl">0.99</span>, <span class="fl">0.44</span>, <span class="fl">0.96</span>, <span class="fl">0.6</span> , <span class="fl">0.54</span>, <span class="fl">0.73</span>,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                     <span class="fl">0.51</span>, <span class="fl">0.86</span>, <span class="fl">0.78</span>, <span class="fl">0.83</span>, <span class="fl">0.99</span>, <span class="fl">0.75</span>, <span class="fl">0.93</span>, <span class="fl">0.94</span>, <span class="fl">0.77</span>, <span class="fl">0.45</span>, <span class="fl">0.93</span>,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                     <span class="fl">0.66</span>, <span class="fl">0.85</span>, <span class="fl">0.63</span>, <span class="fl">0.79</span>, <span class="fl">0.8</span> , <span class="fl">0.75</span>, <span class="fl">0.47</span>, <span class="fl">0.86</span>, <span class="fl">0.73</span>, <span class="fl">0.43</span>, <span class="fl">0.81</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                     <span class="fl">0.8</span> , <span class="fl">0.51</span>, <span class="fl">0.97</span>, <span class="fl">0.66</span>, <span class="fl">0.34</span>, <span class="fl">0.87</span>, <span class="fl">0.93</span>, <span class="fl">0.85</span>, <span class="fl">0.73</span>, <span class="fl">0.5</span> , <span class="fl">0.92</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                     <span class="fl">0.93</span>, <span class="fl">0.59</span>, <span class="fl">0.56</span>, <span class="fl">0.92</span>, <span class="fl">0.82</span>, <span class="fl">0.92</span>])</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>app_temp <span class="op">=</span> np.array([<span class="op">-</span><span class="fl">3.5111</span>, <span class="op">-</span><span class="fl">5.7389</span>, <span class="fl">5.1944</span>, <span class="op">-</span><span class="fl">11.1056</span>, <span class="op">-</span><span class="fl">2.7167</span>, <span class="fl">6.4056</span>, <span class="fl">16.1611</span>, <span class="fl">6.1611</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>                     <span class="fl">15.7889</span>, <span class="fl">19.9500</span>, <span class="fl">1.1000</span>, <span class="fl">13.8889</span>, <span class="fl">14.9500</span>, <span class="fl">8.2833</span>, <span class="fl">0.2167</span>, <span class="fl">11.0444</span>,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>                     <span class="fl">5.2222</span>, <span class="fl">4.5611</span>, <span class="fl">5.5833</span>, <span class="fl">19.2389</span>, <span class="fl">31.900</span>, <span class="fl">0.6333</span>, <span class="fl">22.0611</span>, <span class="fl">17.6389</span>,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>                     <span class="fl">5.0444</span>, <span class="op">-</span><span class="fl">1.3444</span>, <span class="op">-</span><span class="fl">6.700</span>, <span class="op">-</span><span class="fl">2.0222</span>, <span class="fl">21.0333</span>, <span class="fl">1.7778</span>, <span class="fl">10.1389</span>, <span class="fl">22.0222</span>,</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>                     <span class="fl">5.2167</span>, <span class="fl">3.2444</span>, <span class="fl">12.7778</span>, <span class="fl">17.3944</span>, <span class="fl">1.9833</span>, <span class="fl">24.9500</span>, <span class="fl">9.8778</span>, <span class="fl">7.4444</span>,</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>                     <span class="op">-</span><span class="fl">2.7333</span>, <span class="op">-</span><span class="fl">15.1722</span>, <span class="fl">22.7778</span>, <span class="op">-</span><span class="fl">5.5611</span>, <span class="fl">5.0889</span>, <span class="fl">6.9444</span>, <span class="fl">22.0611</span>, <span class="op">-</span><span class="fl">2.0944</span>,</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>                     <span class="fl">5.8056</span>, <span class="op">-</span><span class="fl">2.9222</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="bu">len</span>(app_temp)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>grand_mean <span class="op">=</span> app_temp.mean()</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>b_est, a_est <span class="op">=</span> np.polyfit(humidity, app_temp, <span class="dv">1</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>fit <span class="op">=</span> line(humidity, a_est, b_est)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>xx <span class="op">=</span> np.linspace(<span class="fl">0.2</span>, <span class="dv">1</span>, <span class="dv">100</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>plt.scatter(humidity, app_temp)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>plt.scatter(humidity, fit)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>plt.plot(xx, line(xx, a_est, b_est), color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>plt.hlines(grand_mean, xx[<span class="dv">0</span>], xx[<span class="op">-</span><span class="dv">1</span>], alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="fl">0.22</span>, <span class="op">-</span><span class="dv">10</span>, <span class="ss">f"a=</span><span class="sc">{</span>a_est<span class="sc">:.3f}</span><span class="ss">, b=</span><span class="sc">{</span>b_est<span class="sc">:.3f}</span><span class="ss">"</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>plt.tick_params(labelsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Humidity"</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Apparent temperature"</span>, fontsize<span class="op">=</span><span class="dv">20</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="regression_files/figure-html/cell-19-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>ssy <span class="op">=</span> np.<span class="bu">sum</span>((app_temp <span class="op">-</span> grand_mean)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>sse <span class="op">=</span> np.<span class="bu">sum</span>((app_temp <span class="op">-</span> fit)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>ssr <span class="op">=</span> np.<span class="bu">sum</span>((fit <span class="op">-</span> grand_mean)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>ssx <span class="op">=</span> np.<span class="bu">sum</span>((humidity <span class="op">-</span> humidity.mean())<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>dfe, dfr <span class="op">=</span> n<span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>mse, msr <span class="op">=</span> sse<span class="op">/</span>dfe, ssr<span class="op">/</span>dfr</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>f_ratio <span class="op">=</span> msr<span class="op">/</span>mse</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>r_sq <span class="op">=</span> ssr<span class="op">/</span>ssy</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>eb <span class="op">=</span> np.sqrt(mse<span class="op">/</span>ssx)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>t_val <span class="op">=</span> b_est<span class="op">/</span>eb</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>t_ratio <span class="op">=</span> t.pdf(t_val, df<span class="op">=</span>dfe)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"F   = </span><span class="sc">{</span>f_ratio<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"R^2 = </span><span class="sc">{</span>r_sq<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"t-ratio = </span><span class="sc">{</span>t_ratio<span class="sc">:.2e}</span><span class="ss"> for </span><span class="sc">{</span>t_val<span class="sc">:.2f}</span><span class="ss"> standard deviations away from null hypothesis"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>F   = 24.6608
R^2 = 0.3394
t-ratio = 1.54e-05 for -4.97 standard deviations away from null hypothesis</code></pre>
</div>
</div>
<p>While a large F indicates that the fit line explains a big part of the variance, the low <span class="math inline">\(R^2\)</span> indicates that there is still a lot of error left and that, most likely, there are other aspects besides humidity influencing the apparent temperature.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>t_crit <span class="op">=</span> <span class="fl">2.009</span> <span class="co"># two-sided 95% for 50 df, should be 48 df</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>conf <span class="op">=</span> t_crit<span class="op">*</span>eb</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The vlaue of the slope is </span><span class="sc">{</span>b_est<span class="sc">:.4f}</span><span class="ss">+-</span><span class="sc">{</span>conf<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"The true value lies in (</span><span class="sc">{</span>b_est<span class="op">-</span>conf<span class="sc">:.4f}</span><span class="ss">, </span><span class="sc">{</span>b_est<span class="op">+</span>conf<span class="sc">:.4f}</span><span class="ss">) with 95% confidence."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The vlaue of the slope is -34.1349+-13.8094
The true value lies in (-47.9443, -20.3255) with 95% confidence.</code></pre>
</div>
</div>
<p>The confidence interval for the slope is rather broad, as the sttistical error is quite high (order of 40%). It is not surprising seeing how the data points are spread over the line. Let’s build the prediction interval.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> np.sqrt(mse)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> line(xx, a_est, b_est)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>interval <span class="op">=</span> t_crit<span class="op">*</span>s<span class="op">*</span>np.sqrt(<span class="dv">1</span><span class="op">/</span>m <span class="op">+</span> <span class="dv">1</span><span class="op">/</span>n <span class="op">+</span> (xx <span class="op">-</span> x.mean())<span class="op">/</span>ssx)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>plt.scatter(humidity, app_temp)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>plt.plot(xx, pred, color<span class="op">=</span><span class="st">'r'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>plt.fill_between(xx, pred <span class="op">+</span> interval, pred <span class="op">-</span> interval, alpha<span class="op">=</span><span class="fl">0.15</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>plt.tick_params(labelsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"x"</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"y"</span>, fontsize<span class="op">=</span><span class="dv">20</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="regression_files/figure-html/cell-23-output-1.png" class="img-fluid"></p>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>